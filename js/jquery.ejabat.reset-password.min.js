function validateLogin(a,s){a.removeClass("invalid"),s.removeClass("invalid"),s.empty(),a.val()?val_login=!0:(a.addClass("invalid"),s.addClass("invalid"),s.html(ejabat.empty_field),val_login=!1)}function validatePassword(a,s){var e=a.val(),t=wp.passwordStrength.meter(e,wp.passwordStrength.userInputBlacklist(),e);a.removeClass("invalid too-weak very-weak weak good strong"),s.removeClass("invalid"),s.empty(),e?ejabat.password_strength>0?(0==t&&(a.addClass("too-weak"),s.html(ejabat.password_too_weak)),1==t?(a.addClass("very-weak"),s.html(ejabat.password_very_weak)):2==t?(a.addClass("weak"),s.html(ejabat.password_weak)):3==t?(a.addClass("good"),s.html(ejabat.password_good)):4==t&&(a.addClass("strong"),s.html(ejabat.password_strong)),ejabat.password_strength<=t?val_password=!0:(s.addClass("invalid"),val_password=!1)):val_password=!0:(a.addClass("invalid"),s.addClass("invalid"),s.html(ejabat.empty_field),val_password=!1)}function validatePasswordRetyped(a,s,e){var t=a.val(),r=s.val();r?t&&t!=r?(s.addClass("invalid"),e.addClass("invalid"),e.html(ejabat.passwords_mismatch),val_password_retyped=!1):(s.removeClass("invalid"),e.removeClass("invalid"),e.empty(),val_password_retyped=!0):(s.addClass("invalid"),e.addClass("invalid"),e.html(ejabat.empty_field),val_password_retyped=!1)}function validateRecaptcha(a,s,e){var t=a.val();t||null==t?(s.removeClass("invalid"),e.removeClass("invalid"),e.empty(),val_recaptcha=!0):(s.addClass("invalid"),e.addClass("invalid"),e.html(ejabat.recaptcha_verify),val_recaptcha=!1)}function GetURLParameter(a){for(var s=window.location.search.substring(1),e=s.split("&"),t=0;t<e.length;t++){var r=e[t].split("=");if(r[0]==a)return r[1]}}var val_login,val_password,val_password_retyped,val_recaptcha;jQuery(document).ready(function(a){a.ajax({method:"POST",url:ejabat.ajax_url+"?action=ejabat_reset_password_form",timeout:ejabat.timeout,data:"referer="+window.location.pathname+"&code="+GetURLParameter("code"),dataType:"json",success:function(s){a("#ejabat_reset_password_form").replaceWith(s.data)},error:function(){a("#ejabat_reset_password_form").replaceWith(ejabat.form_error)},complete:function(s,e){"success"==e&&(a("#login input").on("change",function(){a(this).val(a(this).val().toLowerCase().trim()),validateLogin(a(this),a("#login span"))}),a("#password input").on("keyup change",function(s){var e=s.which||s.keyCode;9!==e&&16!==e&&validatePassword(a(this),a("#password span"))}),a("#password_retyped input").on("change",function(){validatePasswordRetyped(a("#password input"),a(this),a("#password_retyped span"))}),a("#ejabat_reset_password").submit(function(){a("#response").css("display",""),a("#response").removeClass("ejabat-form-blocked ejabat-form-error ejabat-form-success"),a("#response").empty(),a("#spinner").css("visibility","visible"),validateRecaptcha(a("#g-recaptcha-response"),a("#g-recaptcha-0"),a("#recaptcha")),val_login&&val_recaptcha?a.ajax({method:"POST",url:ejabat.ajax_url+"?action=ejabat_reset_password",timeout:ejabat.timeout,data:a("#ejabat_reset_password").serialize(),dataType:"json",success:function(s){"success"==s.status&&(a("#ejabat_reset_password")[0].reset(),a("#password span").empty()),a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-"+s.status),a("#response").html(s.message),"undefined"!=typeof Recaptcha&&Recaptcha.reload(),"undefined"!=typeof grecaptcha&&grecaptcha.reset(),a("#spinner").css("visibility","hidden")},error:function(){a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-error"),a("#response").html(ejabat.error),a("#spinner").css("visibility","hidden")}}):(val_login||a("#login input").val()||(a("#login input").addClass("invalid"),a("#login span").addClass("invalid"),a("#login span").html(ejabat.empty_field)),a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-blocked"),a("#response").html(ejabat.empty_fields),a("#spinner").css("visibility","hidden"))}),a("#ejabat_change_password").submit(function(){a("#response").css("display",""),a("#response").removeClass("ejabat-form-blocked ejabat-form-error ejabat-form-success"),a("#response").empty(),a("#spinner").css("visibility","visible"),validateRecaptcha(a("#g-recaptcha-response"),a("#g-recaptcha-0"),a("#recaptcha")),val_password&&val_password_retyped&&val_recaptcha?a.ajax({method:"POST",url:ejabat.ajax_url+"?action=ejabat_reset_password",timeout:ejabat.timeout,data:a("#ejabat_change_password").serialize(),dataType:"json",success:function(s){"success"==s.status&&(a("#ejabat_change_password")[0].reset(),a("#password input").removeClass("weak good strong"),a("#password span").empty()),a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-"+s.status),a("#response").html(s.message),"undefined"!=typeof Recaptcha&&Recaptcha.reload(),"undefined"!=typeof grecaptcha&&grecaptcha.reset(),a("#spinner").css("visibility","hidden")},error:function(){a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-error"),a("#response").html(ejabat.error),a("#spinner").css("visibility","hidden")}}):(val_password||a("#password input").val()||(a("#password input").addClass("invalid"),a("#password span").addClass("invalid"),a("#password span").html(ejabat.empty_field)),val_password_retyped||a("#password_retyped input").val()||(a("#password_retyped input").addClass("invalid"),a("#password_retyped span").addClass("invalid"),a("#password_retyped span").html(ejabat.empty_field)),a("#response").css("display","inline-block"),a("#response").addClass("ejabat-form-blocked"),a("#response").html(ejabat.empty_fields),a("#spinner").css("visibility","hidden"))}))}})});